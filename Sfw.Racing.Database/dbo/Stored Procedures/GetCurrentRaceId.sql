CREATE PROCEDURE [dbo].[GetCurrentRaceId] AS 
SELECT cr.CurrentRaceId, r.RaceDate [CurrentRaceDate], (SELECT max(RaceId) FROM Race WHERE RaceId < cr.CurrentRaceId) [PrevRaceId], (SELECT min(RaceId) FROM Race WHERE RaceId > cr.CurrentRaceId) [NextRaceId] from CurrentRace cr INNER JOIN Race r ON cr.CurrentRaceId = r.RaceId